<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="tech,git," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="作为当前最流行的版本控制利器，git已经越来越成为各类项目首选的版本管理工具，掌握git对于developer来说已经是一项必备技能。">
<meta property="og:type" content="article">
<meta property="og:title" content="git使用心得">
<meta property="og:url" content="http://luck.luckyluck.info/2016/04/29/git/index.html">
<meta property="og:site_name" content="Luck's Cabin">
<meta property="og:description" content="作为当前最流行的版本控制利器，git已经越来越成为各类项目首选的版本管理工具，掌握git对于developer来说已经是一项必备技能。">
<meta property="og:image" content="http://luck.luckyluck.info/img/git-branches.jpg">
<meta property="og:image" content="http://luck.luckyluck.info/img/git-basics.png">
<meta property="og:updated_time" content="2018-11-17T17:40:22.038Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="git使用心得">
<meta name="twitter:description" content="作为当前最流行的版本控制利器，git已经越来越成为各类项目首选的版本管理工具，掌握git对于developer来说已经是一项必备技能。">
<meta name="twitter:image" content="http://luck.luckyluck.info/img/git-branches.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> git使用心得 | Luck's Cabin </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Luck's Cabin</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Amateur Programmer + Tentative Start-uper</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                git使用心得
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-29T00:00:00+08:00" content="2016-04-29">
              2016-04-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/technique/" itemprop="url" rel="index">
                    <span itemprop="name">technique</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>作为当前最流行的版本控制利器，git已经越来越成为各类项目首选的版本管理工具，掌握git对于developer来说已经是一项必备技能。<br><a id="more"></a></p>
<h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><h4 id="master"><a href="#master" class="headerlink" title="master"></a>master</h4><p>master是一个项目中有且仅有一个的主分支，也是给项目加上git特性(<code>git init</code>)或拷贝git项目(<code>git clone</code>)后的默认分支，它应当一直处于可发布的稳定版本状态。每当master更新到一个稳定版本后，可以通过给其打标签的方式标记稳定的版本号。</p>
<h4 id="develop"><a href="#develop" class="headerlink" title="develop"></a>develop</h4><p>develop是用于开发的分支，每当进入版本迭代后及版本发布前，开发团队应在develop分支进行开发，每次版本迭代正式完成时，develop分支应当并入master分支进行版本正式发布。</p>
<h4 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h4><p>feature是当某个迭代较大时，为了开发某个功能，由develop分支分出来的功能分支，通常需要在功能开发完成后再并入develop分支。</p>
<h4 id="release"><a href="#release" class="headerlink" title="release"></a>release</h4><p>release分支叫作预发布分支，顾名思义，就是在版本正式发布即develop分支并入master分支之前用于预先发布(通常用于模拟生产环境的测试)的分支。在预发布到正式发布之间，对代码的修改应当在release分支进行，且这些修改应该仅仅是修复bug，而不进行功能性的改动；修改完毕后，应当并回develop分支。</p>
<h4 id="hotfix"><a href="#hotfix" class="headerlink" title="hotfix"></a>hotfix</h4><p>hotfix是热修复/紧急修复分支。在版本正式发布后，仍然难免会出现bug(e.g. 开发/测试/Stagging环境与生产环境的不同导致bug未在预发布阶段被发现)。此时从master分支分出hotfix分支，紧急修复bug，修复完后并入master及develop分支，通常还需要为master分支打上patch tag(e.g. v1.2-&gt;v1.2.1)。<br>对于某些迭代周期较长的软件来说，开发者会时不时发布hotfix这种小patch给用户来堵漏；当hotfix积累到一定程度后，会将累积的hotfix打包成SP(Service Pack补丁包)，以省去未打补丁的用户逐个堵漏的麻烦。</p>
<p>一张图可以说明上述版本间的关系和区别：<br><img src="/img/git-branches.jpg" alt="img"></p>
<h3 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h3><p>要理解版本控制的原理及代码的流转规则，需要先了解区域的概念，再去熟悉命令，这样才能有清晰的全局概念。由近及远，git管辖的区域包括Workspace, Stage(Index), Repository, Remote四个区域。</p>
<h4 id="Workspace"><a href="#Workspace" class="headerlink" title="Workspace"></a>Workspace</h4><p>Workspace是Developer直接开发的区域，例如项目在本地的文件夹。</p>
<h4 id="Stage-Index"><a href="#Stage-Index" class="headerlink" title="Stage / Index"></a>Stage / Index</h4><p>Stage或Index是位于Workspace和Repository之间的缓存区，如果把Workspace比作货架，Repository比作收银台，那么Stage就是购物车。在把代码从Workspace提交到Repository之前，需要先添加进Stage，或者从Stage中撤出已添加的修改。</p>
<h4 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h4><p>Repository是本地仓库，保存着本地的所有分支及下载的远程分支，用于跟远程仓库同步。</p>
<ul>
<li>如无特别说明，下文中的分支指的都是Repository分支，即本地分支。<h5 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h5>Developer在Workspace进行的每次修改(变更)，都需要先提交到Repository，再提交到Remote，才能与其他Developer同步代码。这样的提交叫作commit，每个commit都被分配了一个SHA-1的hash值作为其ID，记录了变更的详细情况（文件的新增、删除、修改、重命名等）。<br>每次commit都需要添加commit message，对该commit进行说明。</li>
<li>如无特别说明，下文中提到的对某个分支的操作均针对某个Repository分支的最近一次commit。<h5 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h5>HEAD是一个指针，指向本地的活动分支。每次切换分支后，HEAD指向新切换的分支；每次commit后，HEAD随着分支的前进而前进，指向分支的最新commit。<h5 id="index"><a href="#index" class="headerlink" title="index"></a>index</h5>index是一个索引文件，记录每次代码的变化，可以理解为Stage区的具体表现。<h4 id="Remote"><a href="#Remote" class="headerlink" title="Remote"></a>Remote</h4>作为版本控制/代码同步的核心，Remote远程仓库用于版本的统一。Remote在Developer的本地有一个副本，默认名为origin。<h5 id="track"><a href="#track" class="headerlink" title="track"></a>track</h5>各个Repository与Remote进行联系的时候，使用的是以分支为单位的track机制，即每个Repository分支都对某个Remote分支进行track，以此来进行追踪和同步，Repository分支默认track同名的Remote分支。<ul>
<li>如无特别说明，下文中提到的对Remote仓库及Remote某个仓库的操作均为对Remote远程仓库在本地的副本进行的操作，若需更新副本，使用<code>git fetch</code>命令；若需将副本的变更提交到远程，使用<code>git push</code>命令。</li>
</ul>
</li>
</ul>
<p>下面这张图可以理清4个区域的关系：<br><img src="/img/git-basics.png" alt="img"></p>
<h3 id="常用指令清单"><a href="#常用指令清单" class="headerlink" title="常用指令清单"></a>常用指令清单</h3><h4 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h4><p>掌握下面10个命令，日常的开发工作就没多大问题了。</p>
<ul>
<li>init<br>在当前文件夹建立git特征，从此就可以使用git来管理文件夹里的文件了，同时默认切换到master分支。</li>
<li>clone<br>将远程仓库(Remote)里的指定项目整个下载到本地仓库(Repository)，并在当前路径建立Workspace。</li>
<li>fetch<br>将远程仓库里指定项目的所有变更下载到本地仓库。</li>
<li>status<br>显示Workspace里发生变更的文件。</li>
<li>add<br>添加Workspace里的文件到Stage。</li>
<li>commit<br>提交Stage里的文件到Repository。</li>
<li>push<br>将Repository里当前分支的变更提交到Remote。</li>
<li>pull<br>相当于fetch + merge。下载Remote里当前分支的变更，并与Repository里对应的分支合并。</li>
<li>branch<br>对Repository的分支进行操作。</li>
<li>checkout<br>切换分支/覆盖本地修改。</li>
</ul>
<h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><h5 id="新建"><a href="#新建" class="headerlink" title="新建"></a>新建</h5><ul>
<li><p>在当前目录为项目添加git特征。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个空目录，并为其添加git特征。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init [目录]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h5><ul>
<li>从远程仓库下载一个完整的git项目到当前目录(e.g. <code>git clone http://10.10.10.10/test.git</code>)。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone [url]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><p>git的配置文件格式如下，全局配置文件在用户目录下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[user]</span><br><span class="line">	name = Luck</span><br><span class="line">	password = pAsSw0rD</span><br><span class="line">[push]</span><br><span class="line">	default = simple</span><br><span class="line">[credential]</span><br><span class="line">	helper = store</span><br><span class="line">[core]</span><br><span class="line">	autocrlf = false</span><br><span class="line">	quotepath = off</span><br></pre></td></tr></table></figure></p>
<p>因此修改配置时直接按[大项].[小项]名即可设置某个配置项的值。</p>
<ul>
<li><p>修改配置项(e.g. 用户名)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;newLuck&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>直接编辑配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config -e --global</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前的配置信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置命令别名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.&lt;别名&gt; &lt;命令&gt;</span><br><span class="line">git config —-global alias.st status</span><br><span class="line">git config --global alias.cmt commit</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="远程仓库管理"><a href="#远程仓库管理" class="headerlink" title="远程仓库管理"></a>远程仓库管理</h4><ul>
<li><p>显示所有远程仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote [-v]</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载当前本地仓库对应的远程仓库或某个指定远程仓库的所有分支及所有变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch [远程仓库名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示某个远程仓库的详细信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote show [远程仓库名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加远程仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add [远程仓库名] [url]</span><br></pre></td></tr></table></figure>
</li>
<li><p>重命名远程仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote rename [远程仓库名] [新远程仓库名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改远程仓库的url。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote set-url [远程仓库名] [新url]</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除远程仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote remove [远程仓库名]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h4><ul>
<li><p>显示所有Repository的分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示所有Remote的分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -r</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示所有Repository + Remote的分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -a</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个分支，但不切换过去；或切换到已存在的某个分支，同时更新Workspace。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch [分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>从当前分支分出一个新分支并切换过去。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -b [新分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>从当前分支的某个commit新建一个分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch [新分支名] [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>从指定某个分支分出一个新分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b [新分支名] [旧分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>切换到指定分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout [分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>切换到上一个分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个分支，并对指定的Remote分支进行track。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --track [新Repository分支名] [Remote分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>让已存在的分支对指定的Remote分支进行track。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream [Repository分支名] [Remote分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将指定的分支合并进当前分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge [待合并进来的分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将指定分支合并进指定的另外一个分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge [待合并进来的分支] [主动分支]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将某个commit合并进当前分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git cherry-pick [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除指定的Repository分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d [Repository分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除指定的Remote分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -dr [Remote分支名]</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果待合并的分支与主动分支与某个分岔点各有若干次commit(diverged)，将待合并的分支带着所有自分岔点后的commit，合并进主动分支的最后一次commit后。下文将详细展开。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase [主动分支] [待合并的分支]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Workspace与Stage"><a href="#Workspace与Stage" class="headerlink" title="Workspace与Stage"></a>Workspace与Stage</h4><h5 id="提交变更到Stage"><a href="#提交变更到Stage" class="headerlink" title="提交变更到Stage"></a>提交变更到Stage</h5><ul>
<li><p>添加文件/文件夹/当前路径下所有文件到Stage。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git add [file A] [file B] ...</span><br><span class="line"></span><br><span class="line">git add [directory A] [directory B] ...</span><br><span class="line"></span><br><span class="line">git add .</span><br></pre></td></tr></table></figure>
</li>
<li><p>以文件中的块(hunk)为最小单位进行staging，交互式地进行选择。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git add -p / git add --patch</span><br><span class="line">[y,n,q,a,d,/,?]?</span><br><span class="line">? - 使用帮助</span><br><span class="line">y - stage该hunk</span><br><span class="line">n - 不stage该hunk</span><br><span class="line">q - 停止staging选择</span><br><span class="line">a - stage该hunk及后面的所有hunk</span><br><span class="line">d - 不stage该hunk及后面的所有hunk</span><br><span class="line">g - 跳到某个hunk去做选择</span><br><span class="line">/ - 根据后接的正则匹配hunk</span><br><span class="line">s - 将当前hunk切割成更小的hunk</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除Workspace的文件/文件夹，并将删除的变更保存到Stage。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm [file A] [file B] ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>重命名Workspace的文件/文件夹，并将改名的变更保存到Stage。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git mv [file A] [file NewA]</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止track指定的文件(将指定文件的变更从Stage中删除，但Workspace仍然保留该次变更)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached [file X] [file Y] ...</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="撤销变更"><a href="#撤销变更" class="headerlink" title="撤销变更"></a>撤销变更</h5><ul>
<li><p>从Stage恢复变更后的指定文件/全部文件到Workspace。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout [file A] [file B] ...</span><br><span class="line"></span><br><span class="line">git checkout .</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Repository的某个commit恢复文件，同时恢复到Stage和Workspace。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout [commit ID] [file A] [file B] ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Stage中取消指定文件的变更，即将某些文件的变更从Stage中生拽出来，但Workspace仍然有这些变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD [file A] [file B] ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Repository恢复指定文件，将Stage恢复到上一个commit，但Workspace不变。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset [file A] [file B] ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Repository恢复全部文件，将Stage恢复到指定的commit，当前分支的指针指向该commit，但保留Workspace的变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Repository恢复全部文件，恢复到上一个commit，重置Stage和Workspace。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard</span><br></pre></td></tr></table></figure>
</li>
<li><p>从Repository恢复全部文件，恢复到指定的commit，重置Stage和Workspace。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将Repository恢复到某次commit，但保持Stage和Workspace的变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --keep [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个commit，专门用于撤销指定的某次commit，该commit的所有变更都会还原，同时应用到当前分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git revert [commit ID]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="Stash"><a href="#Stash" class="headerlink" title="Stash"></a>Stash</h5><p>有时候我们想要暂时隐藏Workspace和Stage的变更，相当于回滚到上次commit之后Workspace和Stage均clean的状态，待到需要时再将变更还原出来，此时我们就需要用到Stash命令。<br>e.g. pull新代码，但不想立即跟当前的代码合并并产生新的commit，于是先隐藏，pull之后再还原继续写。当然，也可以放弃之前stash的工作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//再继续本地修改前，急于先应用Remote的变更</span><br><span class="line">git stash</span><br><span class="line">git pull</span><br><span class="line">git stash pop</span><br><span class="line">...//继续修改</span><br><span class="line">git commit -m &quot;new commit after pull&quot;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//发现有bug，先把其他修改stash，专门解决bug，再还原做到一半的修改</span><br><span class="line">git stash</span><br><span class="line">git commit --amend [bugged file] -m &quot;bug fixed&quot;</span><br><span class="line">git stash pop</span><br><span class="line">git commit -a -m &quot;new commit after bug fix&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//下载Remote的变更看看，已经有同样的修改，还比我改得好，放弃自己的</span><br><span class="line">git stash</span><br><span class="line">git pull</span><br><span class="line">git stash drop</span><br></pre></td></tr></table></figure>
<p>每次<code>git stash</code>后会将变更缓存到git栈中，需要恢复变更时可以使用<code>git stash pop</code>或<code>git stash apply</code>，两者都会还原stash的变更，但是pop会弹栈，而apply仅仅是读取栈顶的变更。</p>
<h4 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h4><h5 id="提交到Repository"><a href="#提交到Repository" class="headerlink" title="提交到Repository"></a>提交到Repository</h5><ul>
<li><p>将Stage中指定文件的变更提交到Repository。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit [file A] [file B] ... -m [commit message]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将Stage的所有变更提交到Repository。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m [commit message]</span><br></pre></td></tr></table></figure>
</li>
<li><p>将Workspace中的变更直接提交到Repository。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -a</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交时显示变更信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -v</span><br></pre></td></tr></table></figure>
</li>
<li><p>重做上一次commit，如果没有改动，则只修改commit message。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend -m [commit message]</span><br></pre></td></tr></table></figure>
</li>
<li><p>重做上一次commit，并新增指定文件的变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend [file A] [file B] ...</span><br></pre></td></tr></table></figure>
<ul>
<li>使用–amend参数修改的commit，只能修改已经commit到Repository但仍未push到Remote的commit，对于已经push的修改，需要用其他方法。</li>
</ul>
</li>
</ul>
<h5 id="与Remote同步"><a href="#与Remote同步" class="headerlink" title="与Remote同步"></a>与Remote同步</h5><ul>
<li><p>下载指定Remote分支的变更，并与Repository分支合并，同时更新Workspace；remote参数默认为当前分支track的Remote仓库，branch参数默认为当前分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull [remote] [branch]</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传指定Repository分支的变更到Remote分支，如果有冲突将失败；remote参数默认为当前分支track的Remote仓库，branch参数默认为当前分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [remote] [branch]</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传当前Repository分支的变更到指定Remote的分支，即使有冲突仍然进行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [remote] --force</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传所有Repository分支的变更到对应的Remote分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [remote] --all</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h4><ul>
<li><p>显示所有tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag</span><br></pre></td></tr></table></figure>
</li>
<li><p>为最近一次commit新建一个tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag [tag]</span><br></pre></td></tr></table></figure>
</li>
<li><p>为指定的commit新建一个tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag [tag] [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看tag信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show [tag]</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交指定的tag到Remote。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [Remote] [tag]</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交所有的tag到Remote。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [Remote] --tags</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除Repository的tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag -d [tag]</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除Remote的tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push [Remote仓库] :refs/tag/[tag]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="信息查看"><a href="#信息查看" class="headerlink" title="信息查看"></a>信息查看</h4><h5 id="status"><a href="#status" class="headerlink" title="status"></a>status</h5><ul>
<li><p>显示当前分支的变更及track的情况，如超过/落后于Remote分支多少个commit，Workspace中哪些文件有变更等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示简要的变更/track情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status -s</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示指定分支的变更情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status -b [branch]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="log"><a href="#log" class="headerlink" title="log"></a>log</h5><ul>
<li><p>显示当前分支的版本史。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前分支的详细版本史，包括每次commit的文件、commit message以及统计数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --stat</span><br></pre></td></tr></table></figure>
</li>
<li><p>在版本史中根据关键字搜索条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log -S [keyword]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前分支的版本史，每个commit占一行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --pretty=format:%s</span><br></pre></td></tr></table></figure>
</li>
<li><p>筛选commit message符合条件的版本史条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --grep &quot;Merge&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示指定文件的版本史。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --follow [file]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示指定文件的每次diff。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log -p [file]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示最近五次commit。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log -5 --pretty --oneline</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示提交过的用户，按提交次数倒叙排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git shortlog -sn</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示指定文件被哪些用户修改过，以及对应的commit。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git blame [file]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h5><ul>
<li><p>显示Stage和Workspace的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示Stage和当前分支最近一次commit的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff --cached [file]</span><br><span class="line">git diff --staged [file]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示Workspace与当前分支最近一次commit的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff HEAD</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示两次commit的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff [commit A] [commit B]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示以空格为分隔符的变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff --word-diff</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="show"><a href="#show" class="headerlink" title="show"></a>show</h5><ul>
<li><p>显示某次commit的具体信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示某次commit中哪些文件发生了变更。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show --name-only [commit ID]</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示某次commit中某个文件的变更信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show [commit ID]:[文件名]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="reflog"><a href="#reflog" class="headerlink" title="reflog"></a>reflog</h5><ul>
<li>显示当前分支的最近几次commit。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Tricks"><a href="#Tricks" class="headerlink" title="Tricks"></a>Tricks</h3><p><strong>Q</strong>: 跟团队里其他人的代码冲突了怎么办？<br><strong>A</strong>: 冲突不可怕，兵来将挡，冲突来了resolve掉。冲突的时候，会有下面这样的显示，这个时候手动处理也好，Merge Tool也罢，干掉了那些奇怪的标记(<code>&lt;&lt;&lt;&lt; HEAD</code>,<code>====</code>, <code>&gt;&gt;&gt;&gt; 1a2b</code>, etc.) 之后才算resolve掉了冲突，才可以commit。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span><br><span class="line">This is what you&apos;ve written.</span><br><span class="line">======</span><br><span class="line">This is what your teammate&apos;s done.</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1a2b3c</span><br></pre></td></tr></table></figure></p>
<p>当然也有这么几个原则：</p>
<ol>
<li>定好接口，划分模块，理清分支，明确分工，同时每个teammate应该细心打磨自己负责的与整个项目对接的代码。</li>
<li>尽量避免冲突，保证步骤规范：先add + commit或stash，再pull合并。</li>
<li>万一冲突了，而Merge Tool效果不佳时，与冲突的另一方协商，通过文件对比手动resolve冲突，之后新起merge commit。</li>
</ol>
<p><strong>Q</strong>: 关于提交的文件有什么要注意的？<br><strong>A</strong>: 不要提交二进制文件，如：</p>
<ul>
<li>Android项目不要提交gen及bin目录。</li>
<li>Maven项目不要提交target目录。<br>而这些需要由.gitignore文件来控制，下面是一个典型Android项目的<a href="https://github.com/github/gitignore/blob/master/Android.gitignore" target="_blank" rel="external">.gitignore</a>文件。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># Built application files</span><br><span class="line">*.apk</span><br><span class="line">*.ap_</span><br><span class="line"></span><br><span class="line"># Files for the ART/Dalvik VM</span><br><span class="line">*.dex</span><br><span class="line"></span><br><span class="line"># Java class files</span><br><span class="line">*.class</span><br><span class="line"></span><br><span class="line"># Generated files</span><br><span class="line">bin/</span><br><span class="line">gen/</span><br><span class="line">out/</span><br><span class="line"></span><br><span class="line"># Gradle files</span><br><span class="line">.gradle/</span><br><span class="line">build/</span><br><span class="line"></span><br><span class="line"># Local configuration file (sdk path, etc)</span><br><span class="line">local.properties</span><br><span class="line"></span><br><span class="line"># Proguard folder generated by Eclipse</span><br><span class="line">proguard/</span><br><span class="line"></span><br><span class="line"># Log Files</span><br><span class="line">*.log</span><br><span class="line"></span><br><span class="line"># Android Studio Navigation editor temp files</span><br><span class="line">.navigation/</span><br><span class="line"></span><br><span class="line"># Android Studio captures folder</span><br><span class="line">captures/</span><br><span class="line"></span><br><span class="line"># Intellij</span><br><span class="line">*.iml</span><br><span class="line">.idea/workspace.xml</span><br><span class="line">.idea/libraries</span><br><span class="line"></span><br><span class="line"># Keystore files</span><br><span class="line">*.jks</span><br><span class="line"></span><br><span class="line"># External native build folder generated in Android Studio 2.2 and later</span><br><span class="line">.externalNativeBuild</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>Q</strong>: 使用pull更新本地代码时有没有标准动作？<br><strong>A</strong>: pull相当于fetch from upstream + merge into workspace，因此其实pull可以由fetch+merge替代。有以下几个原则需要遵守：</p>
<ol>
<li>pull前，如果Workspace有修改，必须选择将变更commit或stash，才可以进行pull。</li>
<li>如果pull前有commit变更，git会自动合并，自动合并失败的代码需要手动resolve冲突。</li>
<li>如果pull前有stash变更，可以在pull后选择放弃变更或应用变更。</li>
</ol>
<p><strong>Q</strong>: 使用push提交本地修改时有没有标准动作？<br><strong>A</strong>: 首先要pull或fetch + merge代码，使用Merge Tool或手动解决掉所有冲突，确保本地代码不报错，然后确保本地变更已经被add + commit，最后push。</p>
<p><strong>Q</strong>: 粗大事了，我的代码有毛病，怎么放弃修改，让远程仓库覆盖本地？<br><strong>A</strong>: 需要分为几种情况讨论：在Workspace的变更、已add进Stage的变更，已commit到Repository的变更。</p>
<ol>
<li><p>Workspace的变更<br>如果本地什么变更都不想要了，这种情况比较容易处理，只需要<code>git checkout .</code>。<br>如果只是急着获取Remote的代码，并不想丢失本地的变更，如上文stash的描述：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br><span class="line">git pull</span><br><span class="line">git stash apply</span><br></pre></td></tr></table></figure>
</li>
<li><p>Stage的变更<br>已经Stage，尚未commit的变更，需要从Repository的最近一次commit恢复。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD</span><br><span class="line">//强制更新指定的部分文件: git reset HEAD [file1] [file2] ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>Repository的变更<br>若变更已经commit到Repository，这个时候需要回退到Repository中的某次commit，也可以从upstream即Remote来reset：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//从Repository直接reset到某次commit</span><br><span class="line">git reset --hard [commit ID]</span><br><span class="line"></span><br><span class="line">//下载Remote的变更后，强制reset到某次commit</span><br><span class="line">git fetch</span><br><span class="line">git reset --hard [commit ID]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>Q</strong>: 当.gitignore加入到已存在的项目中，偶尔会track不想同步的文件，如何解决？<br><strong>A</strong>: 以下两个例子可以说明。</p>
<ol>
<li><p>e.g. 单次移除不想同步的文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git rm –cache [不想同步的文件]</span><br><span class="line">git commit -a -m &quot;Mr. gitignore, please do your job!&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
</li>
<li><p>e.g. .classpath文件/.project文件在.gitignore生效前添加进了仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- 将.classpath挪出项目</span><br><span class="line">- 修改.gitignore, 确保添加了.classpath条目</span><br><span class="line">- git add &amp; commit &amp; push</span><br><span class="line">- 将.classpath挪回项目</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="合并之Merging-v-s-Rebasing"><a href="#合并之Merging-v-s-Rebasing" class="headerlink" title="合并之Merging v.s. Rebasing"></a>合并之Merging v.s. Rebasing</h3><p><code>git merge</code>和<code>git rebase</code>的效果是类似的，都是将一个分支的变更合并到另外一个分支中。来看这样一个场景，当develop分支分出特性分支(featureA)，之后develop分支前进了两个commit，特性分支也前进了两个commit。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C0-C1-C2-C3       	(develop)</span><br><span class="line">	\</span><br><span class="line">	 C11-C12      	(featureA)</span><br><span class="line"></span><br><span class="line"># By featureA&apos;s developer</span><br><span class="line">git checkout featureA</span><br><span class="line">git fetch</span><br><span class="line">..//C11的修改</span><br><span class="line">git commit -m &quot;C11&quot;</span><br><span class="line">..//C12的修改</span><br><span class="line">git commit -m &quot;C12&quot;</span><br><span class="line">git push</span><br><span class="line"></span><br><span class="line"># By develop branch maintainer</span><br><span class="line">git checkout develop</span><br><span class="line">git fetch</span><br><span class="line">..//C2的修改</span><br><span class="line">git commit -m &quot;C2&quot;</span><br><span class="line">..//C3的修改</span><br><span class="line">git commit -m &quot;C3&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure></p>
<p>此时如果使用merge，将特性分支的变更合入develop分支，就会在develop分支产生一个merge commit(C4)，特性分支保持两个commit不变。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C0-C1-C2-C3--C4       	(develop)</span><br><span class="line">	\       /</span><br><span class="line">	 C11-C12        (featureA)</span><br><span class="line"></span><br><span class="line"># By develop branch maintainer</span><br><span class="line">git checkout develop</span><br><span class="line">git fetch</span><br><span class="line">git merge featureA</span><br><span class="line">..//解决冲突</span><br><span class="line">git commit -m &quot;C4&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure></p>
<p>而此时如果rebase，会将特性分支两次commit的变更灵活地扦插到develop分支上，以patch commit即补丁的形式加在develop的最新commit后面。rebase使得版本史中的commit都在一条线上，不会有merge commit的产生，看起来更清晰。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">C0-C1-C2-C3      		  (featureA)</span><br><span class="line"></span><br><span class="line">C0-C1-C2-C3-C11&apos;-C12&apos;     	  (develop)</span><br><span class="line">	 </span><br><span class="line">      C11(discarded)-C12(discarded)              </span><br><span class="line"></span><br><span class="line"># By featureA&apos;s developer</span><br><span class="line">git checkout featureA</span><br><span class="line">git fetch</span><br><span class="line">git rebase develop</span><br><span class="line">..//冲突产生了，有三个方案</span><br><span class="line"></span><br><span class="line">//1. 解决冲突，继续rebase</span><br><span class="line">..//解决冲突</span><br><span class="line">git add [fileA] [fileB] ...</span><br><span class="line">git rebase --continue</span><br><span class="line">//不需要再次commit, git会继续打补丁</span><br><span class="line"></span><br><span class="line">//2. 放弃引起冲突的featureA分支的commit</span><br><span class="line">git rebase --skip</span><br><span class="line"></span><br><span class="line">//3. 放弃此次rebase</span><br><span class="line">git rebase --abort</span><br><span class="line"></span><br><span class="line">git push</span><br></pre></td></tr></table></figure></p>
<p>同时也可以使用git rebase -i进行交互式地rebase。</p>
<h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p>Github是全球最大的<del>同性交友平台</del>git协作平台，成千上万的开源项目都在该平台上热火朝天地进行着，无数人在贡献着设计、代码、文档，而贡献的途径主要是PR Pull Request。</p>
<h4 id="PR"><a href="#PR" class="headerlink" title="PR"></a>PR</h4><p>首先需要了解的是，提交PR前，需要将原项目Fork到自己名下，即复制一份到自己的github账号里。<br>在contribution的过程中，有三个角色需要注意。</p>
<ul>
<li>upstream<br>这是项目的公共仓库，所有开发者的代码在此同步。</li>
<li>origin<br>这是自己的仓库，作为本地和upstream的桥梁。</li>
<li>local<br>本地仓库。</li>
</ul>
<p>远程仓库需要这样配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git remote remove origin</span><br><span class="line">git remote add origin Luck/[project-name]</span><br><span class="line">git remote add upstream [organization-name]/[project-name]</span><br><span class="line">git remote set-url --push upstream no-pushing</span><br></pre></td></tr></table></figure></p>
<p>通常的步骤如下：</p>
<ol>
<li>upstream(master) sync到local master。</li>
<li>在local：<ol>
<li>master切出fix-issue-xxx分支。</li>
<li>coding，fix-issue-xxx分支经过若干次commit后变为fix-issue-xxx’分支。</li>
<li>local push fix-issue-xxx’分支到origin。</li>
</ol>
</li>
<li>在github：<ol>
<li>提交PR，来源为origin的fix-issue-xxx’分支，填写PR description。</li>
<li>maintainer review，经过一系列探讨及黑话交流 e.g. SGTM(Sounds Good To Me), LGTM(Looks Good To Me), PTAL(Please Take A Look)后，决定通过与否。</li>
<li>PR status=1-desgin review, 2-code review, 3-doc review, 4-merge。</li>
<li>正式merge！upstream master-&gt;master’。</li>
</ol>
</li>
<li>upstream(master’) sync到local，local master-&gt;master’。</li>
</ol>
<p>关于PR，有几点需要注意：</p>
<ol>
<li>Sign your commit，授信确保不会被假冒。</li>
<li>In one commit，必要时squash。</li>
<li>Commit message应当简明扼要又包含足够多的信息。</li>
<li>PR description应当按规范填写。</li>
<li>Fixed issue referenced，确保解决的issue都提到了。</li>
</ol>
<h4 id="项目人员组织架构"><a href="#项目人员组织架构" class="headerlink" title="项目人员组织架构"></a>项目人员组织架构</h4><ul>
<li>Chief Arch<br>首席架构师, BDFL Benevolent Dictator For Life, 但是一般不行使独裁权，负责所有子系统技术架构的全局完整性。</li>
<li>运营团队<br>管理项目发行，促进社区沟通；管理下游分发与上游依赖关系。</li>
<li>Maintainer<ul>
<li>首席Maintainer：项目各方面的质量把控。</li>
<li>Core Maintainer：整体模块的技术、风格、<strong>哲学</strong>。</li>
<li>子系统Maintainer：对应子系统的路线图规划，PR和Bug管理。</li>
</ul>
</li>
<li>Curator 监管者<br>问题和PR分类，引导贡献者到相关资料和讨论。</li>
<li>Release Captain<br>负责每一次release，由core maintainer轮值。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://git-scm.com/docs" target="_blank" rel="external">Git Documentation - git-scm</a><br><a href="https://github.com/HackBerkeley/intro-git" target="_blank" rel="external">Intro-git - HackBerkeley</a><br><a href="https://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="external">极简教程</a><br><a href="https://learngitbranching.js.org" target="_blank" rel="external">分支游戏</a></p>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/tech/" rel="tag">#tech</a>
          
            <a href="/tags/git/" rel="tag">#git</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/04/17/JVM Basics/" rel="next" title="JVM初探">
                <i class="fa fa-chevron-left"></i> JVM初探
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/05/12/Maven Cook Book/" rel="prev" title="Maven Cook Book">
                Maven Cook Book <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/avatar.jpg"
               alt="Mr. Luck a.k.a. Zeon Git. Lau a.k.a. Jun Jie Liu" />
          <p class="site-author-name" itemprop="name">Mr. Luck a.k.a. Zeon Git. Lau a.k.a. Jun Jie Liu</p>
          <p class="site-description motion-element" itemprop="description">You can do anything, but not everything.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">24</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://mars.run/" target="_blank">Mars</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://hetaotao.net/" target="_blank">Daniel</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/ericnie" target="_blank">Eric</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#分支"><span class="nav-number">1.</span> <span class="nav-text">分支</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#master"><span class="nav-number">1.1.</span> <span class="nav-text">master</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#develop"><span class="nav-number">1.2.</span> <span class="nav-text">develop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#feature"><span class="nav-number">1.3.</span> <span class="nav-text">feature</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#release"><span class="nav-number">1.4.</span> <span class="nav-text">release</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hotfix"><span class="nav-number">1.5.</span> <span class="nav-text">hotfix</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#区域"><span class="nav-number">2.</span> <span class="nav-text">区域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Workspace"><span class="nav-number">2.1.</span> <span class="nav-text">Workspace</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Stage-Index"><span class="nav-number">2.2.</span> <span class="nav-text">Stage / Index</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Repository"><span class="nav-number">2.3.</span> <span class="nav-text">Repository</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#commit"><span class="nav-number">2.3.1.</span> <span class="nav-text">commit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HEAD"><span class="nav-number">2.3.2.</span> <span class="nav-text">HEAD</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#index"><span class="nav-number">2.3.3.</span> <span class="nav-text">index</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remote"><span class="nav-number">2.4.</span> <span class="nav-text">Remote</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#track"><span class="nav-number">2.4.1.</span> <span class="nav-text">track</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用指令清单"><span class="nav-number">3.</span> <span class="nav-text">常用指令清单</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本命令"><span class="nav-number">3.1.</span> <span class="nav-text">基本命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#初始化"><span class="nav-number">3.2.</span> <span class="nav-text">初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#新建"><span class="nav-number">3.2.1.</span> <span class="nav-text">新建</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#拷贝"><span class="nav-number">3.2.2.</span> <span class="nav-text">拷贝</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#配置"><span class="nav-number">3.2.3.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#远程仓库管理"><span class="nav-number">3.3.</span> <span class="nav-text">远程仓库管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分支管理"><span class="nav-number">3.4.</span> <span class="nav-text">分支管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Workspace与Stage"><span class="nav-number">3.5.</span> <span class="nav-text">Workspace与Stage</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#提交变更到Stage"><span class="nav-number">3.5.1.</span> <span class="nav-text">提交变更到Stage</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#撤销变更"><span class="nav-number">3.5.2.</span> <span class="nav-text">撤销变更</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Stash"><span class="nav-number">3.5.3.</span> <span class="nav-text">Stash</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#同步"><span class="nav-number">3.6.</span> <span class="nav-text">同步</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#提交到Repository"><span class="nav-number">3.6.1.</span> <span class="nav-text">提交到Repository</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#与Remote同步"><span class="nav-number">3.6.2.</span> <span class="nav-text">与Remote同步</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#标签"><span class="nav-number">3.7.</span> <span class="nav-text">标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#信息查看"><span class="nav-number">3.8.</span> <span class="nav-text">信息查看</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#status"><span class="nav-number">3.8.1.</span> <span class="nav-text">status</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#log"><span class="nav-number">3.8.2.</span> <span class="nav-text">log</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#diff"><span class="nav-number">3.8.3.</span> <span class="nav-text">diff</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#show"><span class="nav-number">3.8.4.</span> <span class="nav-text">show</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#reflog"><span class="nav-number">3.8.5.</span> <span class="nav-text">reflog</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tricks"><span class="nav-number">4.</span> <span class="nav-text">Tricks</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合并之Merging-v-s-Rebasing"><span class="nav-number">5.</span> <span class="nav-text">合并之Merging v.s. Rebasing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Github"><span class="nav-number">6.</span> <span class="nav-text">Github</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PR"><span class="nav-number">6.1.</span> <span class="nav-text">PR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#项目人员组织架构"><span class="nav-number">6.2.</span> <span class="nav-text">项目人员组织架构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考资料"><span class="nav-number">7.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr. Luck a.k.a. Zeon Git. Lau a.k.a. Jun Jie Liu</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  

  
  


</body>
</html>
